<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="css/dashboard_page.css">
    <link rel="icon" type="image/x-icon" href="images/logo.png">
    <title>Electric Bill Calculator</title>
</head>
<body>


    <div class="container-bar">
        <aside class="sidebar">
            <div class="logo-section">
                <img src="images/logo.png" alt="Logo" class="logo">
                <p class="logo-text">ELBC</p>
            </div>

            <nav class="nav-menu">

                <a class="nav-item active">
                    <img src="images/dashboard_icon.png" alt="icon" class="nav-icon">
                    <span>Dashboard</span>
                </a>
                <a href="calculator_page.html" class="nav-item">
                    <img src="images/calculator_icon.png" alt="icon" class="nav-icon">
                    <span>Calculator</span>
                </a>
                <a href="result_page.html" class="nav-item">
                    <img src="images/result_icon.png" alt="icon" class="nav-icon">
                    <span>Results</span>
                </a>
                <a href="profile_page.html" class="nav-item">
                    <img src="images/profile_icon.png" alt="icon" class="nav-icon">
                    <span>Profile</span>
                </a>
            </nav>
        </aside>

        <main class="main-content">
            <!-- Dashboard Content -->
            <div class="content-wrapper">

                <h1 class="welcome-text">Welcome back! Start calculating today,<br> saving energy and money begins  here!</h1>

                <!-- The recently result  -->
                <div class="recent-results">
                    <h3 class="card-title">Recent Result <span class="card-subtitle">(Last Month)</span></h3>

                    <div class="month-list">
                        <div class="month-item">
                            <span class="month-name">January</span>
                            <span class="year-small">2025</span>
                        </div>
                        <div class="month-item">
                            <span class="month-name">February</span>
                            <span class="year-small">2025</span>
                        </div>
                        <div class="month-item">
                            <span class="month-name">March</span>
                            <span class="year-small">2025</span>
                        </div>
                        <div class="month-item">
                            <span class="month-name">April</span>
                            <span class="year-small">2025</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        
        // Check authentication on page load
        document.addEventListener('DOMContentLoaded', async () => {
            const session = await initAuth();
            if (session) {
                const user = await getCurrentUser();
                if (user) {
                    // Update welcome message with user name if available
                    const welcomeText = document.querySelector('.welcome-text');
                    const userName = user.user_metadata?.full_name || user.email;
                    if (welcomeText) {
                        welcomeText.textContent = `Welcome back, ${userName}! Start calculating today, saving energy and money begins here!`;
                    }
                }
            }
        });

        async function handleLogout() {
            const success = await signOut();
            if (success) {
                window.location.href = 'login_page.html';
            } else {
                alert('Error logging out. Please try again.');
            }
        }

    </script>

</body>
</html>